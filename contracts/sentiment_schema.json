{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://hasharita/contracts/sentiment_schema.json",
  "title": "HasHarita Sentiment & Topics API Contract",
  "$defs": {
    "GeoPoint": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "lat": { "type": "number", "minimum": -90, "maximum": 90 },
        "lon": { "type": "number", "minimum": -180, "maximum": 180 }
      },
      "required": ["lat", "lon"]
    },
    "TopicScore": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "label": { "type": "string", "minLength": 1 },
        "score": { "type": "number", "minimum": 0, "maximum": 1 }
      },
      "required": ["label", "score"]
    },
    "Sentiment": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "label": { "type": "string", "enum": ["positive", "neutral", "negative"] },
        "score": { "type": "number", "minimum": 0, "maximum": 1 }
      },
      "required": ["label", "score"]
    },
    "SentimentRequest": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": { "type": "string" },
        "text": { "type": "string", "minLength": 1 },
        "lang": { "type": "string", "enum": ["tr", "en", "auto"], "default": "auto" },
        "timestamp": { "type": "string", "format": "date-time" },
        "geo": { "$ref": "#/$defs/GeoPoint" },
        "tags": { "type": "array", "items": { "type": "string" }, "maxItems": 10 }
      },
      "required": ["id", "text"],
      "examples": [
        {
          "id": "tw_001",
          "text": "Beşiktaş'ta yollar sular altında, yardım lazım.",
          "lang": "tr",
          "timestamp": "2025-08-28T17:35:00Z",
          "geo": { "lat": 41.043, "lon": 29.009 },
          "tags": ["#sel", "#yardım"]
        }
      ]
    },
    "SentimentResponse": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": { "type": "string" },
        "sentiment": { "$ref": "#/$defs/Sentiment" },
        "topics": {
          "type": "array",
          "items": { "$ref": "#/$defs/TopicScore" },
          "maxItems": 10
        }
      },
      "required": ["id", "sentiment"],
      "examples": [
        {
          "id": "tw_001",
          "sentiment": { "label": "negative", "score": 0.91 },
          "topics": [
            { "label": "altyapi", "score": 0.63 },
            { "label": "yardim", "score": 0.52 }
          ]
        }
      ]
    }
  },
  "description": "Use #/$defs/SentimentRequest for request validation and #/$defs/SentimentResponse for response validation."
}
